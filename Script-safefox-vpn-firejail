#!/bin/bash

# --------------------------------------------
# Script d‚Äôinstallation SafeFox
# Installe firejail, Firefox et cr√©e l‚Äôalias safefox
# Compatible Debian / Ubuntu / Kali
# --------------------------------------------

echo "üîê [SafeFox] D√©marrage de l'installation..."

# V√©rifie si l'utilisateur est root (Kali peut l'√™tre par d√©faut)
if [ "$EUID" -eq 0 ]; then
echo "‚ö†  Vous ex√©cutez ce script en tant que root."
echo "Kali Linux utilise parfois root par d√©faut."
read -p "Voulez-vous continuer ? (y/n) : " confirm
if [[ "$confirm" != "y" && "$confirm" != "Y" ]]; then
echo "  Installation annul√©e par l'utilisateur."
exit 1
fi
fi

# Mise √† jour des paquets
echo " Mise √† jour du syst√®me..."
sudo apt update -y

# Installation de firejail et firefox
echo " Installation de firejail et firefox-esr..."
sudo apt install -y firejail firefox-esr

# D√©tection du fichier de configuration du shell
if [ -f "$HOME/.zshrc" ]; then
SHELL_RC="$HOME/.zshrc"
elif [ -f "$HOME/.bashrc" ]; then
SHELL_RC="$HOME/.bashrc"
else
echo "‚ùó Fichier .bashrc ou .zshrc introuvable"
exit 1
fi

# Ajout de l‚Äôalias safefox si non existant
if grep -q "alias safefox=" "$SHELL_RC"; then
echo " Alias 'safefox' d√©j√† pr√©sent dans $SHELL_RC"
else
echo "‚öôÔ∏è Ajout de l‚Äôalias safefox..."
echo "alias safefox='firejail --private firefox'" >> "$SHELL_RC"
echo " Alias ajout√© avec succ√®s."
fi

# Instruction finale √† l'utilisateur
echo " Ouvrez un nouveau terminal ou tapez :"
echo " source $SHELL_RC"
echo "pour que la commande 'safefox' soit activ√©e."

echo " Installation termin√©e. Lancez : safefox"
